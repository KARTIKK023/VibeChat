services:
  - type: web
    name: chat-app
    env: node
    plan: free

    # ✅ Force Render to use Node 20 (Vite-friendly)
    nodeVersion: 20

    # ✅ Force installation of devDependencies (Vite, Tailwind, etc.)
    buildCommand: |
      npm ci --prefix backend
      npm ci --prefix frontend --include=dev
      npm run build --prefix frontend

    # ✅ Start backend (which also serves frontend)
    startCommand: npm run start --prefix backend

    envVars:
      - key: NODE_ENV
        value: production

     