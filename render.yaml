services:
  - type: web
    name: chat-app
    env: node
    plan: free

    # ✅ Force Render to use Node 20 (more stable for Vite)
    nodeVersion: 20

    # ✅ Install both backend and frontend deps including dev packages
    buildCommand: |
      npm ci --prefix backend
      npm ci --prefix frontend --include=dev
      npm run build --prefix frontend

    # ✅ Start backend (serves both frontend & API)
    startCommand: npm run start --prefix backend

    envVars:
      - key: NODE_ENV
        value: production

     